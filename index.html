<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tissot Indicatrix for Map Projection Distortion • tissot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Tissot Indicatrix for Map Projection Distortion">
<meta property="og:description" content="Compute and visualize the Tissot Indicatrix for map projections. The indicatrix characterizes projection distortion by computing scale factors, angular deformation, areal distortion, and convergence at arbitrary points. Based on the calculations shared by Bill Huber on &lt;https://gis.stackexchange.com/a/5075/482&gt;. Uses GDAL for coordinate transformation. Developed using the method published in Snyder, JP (1987) &lt;doi:10.3133/pp1395&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tissot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hypertidy/tissot/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">


<div class="section level1">
<div class="page-header"><h1 id="tissot">tissot<a class="anchor" aria-label="anchor" href="#tissot"></a>
</h1></div>
<p>The <a href="https://en.wikipedia.org/wiki/Tissot%27s_indicatrix" class="external-link">Tissot Indicatrix</a> characterizes local distortion in map projections. This package computes and plots indicatrixes using a vectorized finite-difference Jacobian with <a href="https://firelab.github.io/gdalraster/" class="external-link">gdalraster</a> as the projection engine.</p>
<p>Derived (with permission) from Bill Huber’s <a href="https://gis.stackexchange.com/a/5075/482" class="external-link">GIS StackExchange answer</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"hypertidy/tissot@refactor-2026"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p><code><a href="reference/tissot.html">tissot()</a></code> returns a tibble of distortion properties. The second argument is the projection <code>target</code>; <code>source</code> defaults to EPSG:4326:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hypertidy/tissot" class="external-link">tissot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147</span>, <span class="op">-</span><span class="fl">42</span><span class="op">)</span>, <span class="st">"+proj=utm +zone=55 +south"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tissot indicatrix: 1 point, +proj=utm +zone=55 +south</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 14</span></span>
<span><span class="co">#&gt;       x     y dx_dlam    dy_dlam dx_dphi dy_dphi scale.h scale.k scale.omega</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1   147   -42 0.99960 -5.8386e-7       0 0.99960 0.99960 0.99960 0.000033471</span></span>
<span><span class="co">#&gt; # ℹ 5 more variables: scale.a &lt;dbl&gt;, scale.b &lt;dbl&gt;, scale.area &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   angle_deformation &lt;dbl&gt;, convergence &lt;dbl&gt;</span></span></code></pre></div>
<p>Columns include: <code>scale.h</code> (meridional), <code>scale.k</code> (parallel), <code>scale.a</code> / <code>scale.b</code> (max/min singular values), <code>scale.area</code>, <code>angle_deformation</code>, and <code>convergence</code>.</p>
</div>
<div class="section level2">
<h2 id="plotting-indicatrixes">Plotting indicatrixes<a class="anchor" aria-label="anchor" href="#plotting-indicatrixes"></a>
</h2>
<p><code><a href="reference/indicatrix.html">indicatrix()</a></code> builds plottable ellipses. The dashed circle is the undistorted reference; the filled ellipse shows the projection’s distortion:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">150</span>, <span class="fl">150</span>, by <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">60</span>, <span class="fl">60</span>, by <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="va">xy</span>, <span class="st">"+proj=robin"</span><span class="op">)</span></span>
<span><span class="va">ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ii</span>, scale <span class="op">=</span> <span class="fl">6e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, show.axes  <span class="op">=</span> <span class="cn">TRUE</span>, show.circle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span></code></pre></div>
<p><img src="reference/figures/README-robinson-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="colour-coded-distortion">Colour-coded distortion<a class="anchor" aria-label="anchor" href="#colour-coded-distortion"></a>
</h2>
<p>Pass <code>fill.by</code> to colour ellipses by a distortion metric:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ii</span>, scale <span class="op">=</span> <span class="fl">6e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, fill.by <span class="op">=</span> <span class="st">"scale.area"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span></code></pre></div>
<p><img src="reference/figures/README-coloured-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="projection-comparison">Projection comparison<a class="anchor" aria-label="anchor" href="#projection-comparison"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="va">xy</span>, <span class="st">"+proj=moll"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">5e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span></code></pre></div>
<p><img src="reference/figures/README-mollweide-1.png"><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merc_xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">150</span>, <span class="fl">150</span>, by <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75</span>, <span class="fl">75</span>, by <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="va">merc_xy</span>, <span class="st">"+proj=merc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">5e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span></code></pre></div>
<p><img src="reference/figures/README-mercator-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="rich-single-indicatrix-plots">Rich single-indicatrix plots<a class="anchor" aria-label="anchor" href="#rich-single-indicatrix-plots"></a>
</h2>
<p>A single indicatrix with axes and reference circle:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ii2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147</span>, <span class="op">-</span><span class="fl">42</span><span class="op">)</span>, <span class="st">"+proj=lcc +lat_1=-36 +lat_2=-38 +lat_0=-37 +lon_0=145"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ii2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, scale <span class="op">=</span> <span class="fl">1e4</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, show.axes <span class="op">=</span> <span class="cn">TRUE</span>, show.circle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-single2-1.png"><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ii3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147</span>, <span class="op">-</span><span class="fl">42</span><span class="op">)</span>, <span class="st">"+proj=lcc +lat_1=-15 +lat_2=5 +lat_0=0 +lon_0=145"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ii3</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, scale <span class="op">=</span> <span class="fl">1e4</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, show.axes <span class="op">=</span> <span class="cn">TRUE</span>, show.circle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-single3-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="arbitrary-projections">Arbitrary projections<a class="anchor" aria-label="anchor" href="#arbitrary-projections"></a>
</h2>
<p>Lambert Conformal Conic</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, by <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75</span>, <span class="op">-</span><span class="fl">45</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="va">pxy</span>, <span class="st">"+proj=lcc +lat_0=-60 +lon_0=147 +lat_1=-70 +lat_2=-55"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">3e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, fill.by <span class="op">=</span> <span class="st">"scale.area"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span></code></pre></div>
<p><img src="reference/figures/README-lcc-1.png"><!-- --></p>
<p>Universal Transverse Mercator</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, by <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75</span>, <span class="op">-</span><span class="fl">45</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="va">qxy</span>, <span class="st">"EPSG:32755"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">3e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, fill.by <span class="op">=</span> <span class="st">"scale.area"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; GDAL FAILURE 1: Point outside of projection domain</span></span>
<span><span class="co">#&gt; GDAL FAILURE 1: Point outside of projection domain</span></span>
<span><span class="co">#&gt; GDAL FAILURE 1: Point outside of projection domain</span></span>
<span><span class="co">#&gt; GDAL FAILURE 1: Point outside of projection domain</span></span>
<span><span class="co">#&gt; GDAL FAILURE 1: Point outside of projection domain</span></span>
<span><span class="co">#&gt; GDAL FAILURE 1: Point outside of projection domain</span></span>
<span><span class="co">#&gt; GDAL FAILURE 1: Point outside of projection domain</span></span>
<span><span class="co">#&gt; GDAL FAILURE 1: Point outside of projection domain</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 8 point(s) failed to</span></span>
<span><span class="co">#&gt; transform, NA returned in that case</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span></code></pre></div>
<p><img src="reference/figures/README-utm-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="polar-projections">Polar projections<a class="anchor" aria-label="anchor" href="#polar-projections"></a>
</h2>
<p>In any projection we should refer to a regular grid of points in it’s crs, else we get weird situations like this, more obvious on an actual pole:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polar_xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">150</span>, by <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">80</span>, <span class="op">-</span><span class="fl">50</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="va">polar_xy</span>, <span class="st">"+proj=stere +lat_0=-90 +lon_0=147"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">2.5e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, fill.by <span class="op">=</span> <span class="st">"scale.area"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span></code></pre></div>
<p><img src="reference/figures/README-polar-1.png"><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">la</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="va">polar_xy</span>, <span class="st">"+proj=laea +lat_0=-90 +lon_0=147"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="va">la</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">2.5e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span></code></pre></div>
<p><img src="reference/figures/README-laea-1.png"><!-- --></p>
<p>If we push away from the pole in Lambert Azimuthal Equidistant it’s useful to see what happens.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lea</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="va">polar_xy</span>, <span class="st">"+proj=aeqd +lat_0=-20 +lon_0=147"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="va">lea</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">2.5e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span></code></pre></div>
<p><img src="reference/figures/README-aeqd-1.png"><!-- --></p>
<p>Far better is to generate a grid in the crs we are assessing.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">150</span>, <span class="op">-</span><span class="fl">80</span>, <span class="op">-</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">crs</span> <span class="op">&lt;-</span> <span class="st">"+proj=stere +lat_0=-90 +lon_0=147"</span></span>
<span><span class="va">projext</span> <span class="op">&lt;-</span> <span class="fu">gdalraster</span><span class="fu">::</span><span class="fu"><a href="https://firelab.github.io/gdalraster/reference/bbox_transform.html" class="external-link">bbox_transform</a></span><span class="op">(</span><span class="va">ext</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, srs_to <span class="op">=</span> <span class="va">crs</span>, srs_from <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">polar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">projext</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span>, <span class="va">projext</span><span class="op">[</span><span class="fl">3L</span><span class="op">]</span>, by <span class="op">=</span> <span class="fl">30</span> <span class="op">*</span> <span class="fl">1e5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">projext</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">projext</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, by <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">polar_xy</span> <span class="op">&lt;-</span> <span class="fu">gdalraster</span><span class="fu">::</span><span class="fu"><a href="https://firelab.github.io/gdalraster/reference/transform_xy.html" class="external-link">transform_xy</a></span><span class="op">(</span><span class="va">polar</span>, srs_to <span class="op">=</span> <span class="st">"EPSG:4326"</span>, srs_from <span class="op">=</span> <span class="va">crs</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="va">polar_xy</span>, <span class="va">crs</span>, source <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">2.5e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, fill.by <span class="op">=</span> <span class="st">"scale.area"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span>
<span></span>
<span><span class="va">ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">150</span>, <span class="op">-</span><span class="fl">80</span>, <span class="op">-</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">crs</span> <span class="op">&lt;-</span> <span class="st">"+proj=laea +lat_0=-90 +lon_0=147"</span></span>
<span><span class="va">projext</span> <span class="op">&lt;-</span> <span class="fu">gdalraster</span><span class="fu">::</span><span class="fu"><a href="https://firelab.github.io/gdalraster/reference/bbox_transform.html" class="external-link">bbox_transform</a></span><span class="op">(</span><span class="va">ext</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, srs_to <span class="op">=</span> <span class="va">crs</span>, srs_from <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">polar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">projext</span><span class="op">[</span><span class="fl">1L</span><span class="op">]</span>, <span class="va">projext</span><span class="op">[</span><span class="fl">3L</span><span class="op">]</span>, by <span class="op">=</span> <span class="fl">30</span> <span class="op">*</span> <span class="fl">1e5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">projext</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">projext</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, by <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">polar_xy</span> <span class="op">&lt;-</span> <span class="fu">gdalraster</span><span class="fu">::</span><span class="fu"><a href="https://firelab.github.io/gdalraster/reference/transform_xy.html" class="external-link">transform_xy</a></span><span class="op">(</span><span class="va">polar</span>, srs_to <span class="op">=</span> <span class="st">"EPSG:4326"</span>, srs_from <span class="op">=</span> <span class="va">crs</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tissot.html">tissot</a></span><span class="op">(</span><span class="va">polar_xy</span>, <span class="va">crs</span>, source <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/indicatrix.html">indicatrix</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">2.5e5</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, fill.by <span class="op">=</span> <span class="st">"scale.area"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/tissot_map.html">tissot_map</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .transform_xy(pts_in, srs_from, srs_to): 1972 point(s) had missing</span></span>
<span><span class="co">#&gt; values, NA returned in that case</span></span></code></pre></div>
<p><img src="reference/figures/README-polar-proj-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="distortion-summary">Distortion summary<a class="anchor" aria-label="anchor" href="#distortion-summary"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tissot indicatrix: 55 points</span></span>
<span><span class="co">#&gt;   Source CRS: EPSG:4326</span></span>
<span><span class="co">#&gt;   Target CRS: +proj=robin</span></span>
<span><span class="co">#&gt;   Areal scale:  min=0.8209  max=1.2790  mean=1.0468</span></span>
<span><span class="co">#&gt;   Angular def:  min=1.5058  max=52.3188  mean=21.3786 deg</span></span>
<span><span class="co">#&gt;   Scale h:      min=0.8790  max=1.3023  (meridional)</span></span>
<span><span class="co">#&gt;   Scale k:      min=0.8487  max=1.3521  (parallel)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="why-this-package">Why this package?<a class="anchor" aria-label="anchor" href="#why-this-package"></a>
</h2>
<p>Most “Tissot indicatrix” plots you’ll find online are just geographic circles drawn on the map. They show what happens to a circle under the projection, which is useful — but it’s not the indicatrix. The indicatrix is the Jacobian of the projection at a point: it gives you actual scale factors, angular deformation, and areal distortion. This package computes those.</p>
<p>Other examples: <a href="https://mgimond.github.io/tissot/" class="external-link">mgimond</a>.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the tissot project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/hypertidy/tissot/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/hypertidy/tissot/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tissot</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Michael Sumner <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-2471-7511" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Bill Huber <br><small class="roles"> Author </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/hypertidy/tissot/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/hypertidy/tissot/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Sumner, Bill Huber.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
