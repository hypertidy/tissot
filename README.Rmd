---
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  fig.height = 7,
  fig.width = 7
)
```

<!-- badges: start -->
[![R-CMD-check](https://github.com/hypertidy/tissot/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/hypertidy/tissot/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

# tissot

The [Tissot Indicatrix](https://en.wikipedia.org/wiki/Tissot%27s_indicatrix)
characterizes local distortion in map projections. This package computes and
plots indicatrixes using a vectorized finite-difference Jacobian with
[gdalraster](https://firelab.github.io/gdalraster/) as the
projection engine.

Derived (with permission) from Bill Huber's
[GIS StackExchange answer](https://gis.stackexchange.com/a/5075/482).

## Installation

```r
# install.packages("pak")
pak::pak("hypertidy/tissot@refactor-2026")
```

## Quick start

`tissot()` returns a tibble of distortion properties. The second argument
is the projection `target`; `source` defaults to EPSG:4326:

```{r quick}
library(tissot)
tissot(c(147, -42), "+proj=utm +zone=55 +south")
```

Columns include: `scale.h` (meridional), `scale.k` (parallel), `scale.a` /
`scale.b` (max/min singular values), `scale.area`, `angle_deformation`, and
`convergence`.

## Plotting indicatrixes

`indicatrix()` builds plottable ellipses. The dashed circle is the
undistorted reference; the filled ellipse shows the projection's distortion:

```{r robinson}
xy <- expand.grid(seq(-150, 150, by = 30), seq(-60, 60, by = 30))
r <- tissot(xy, "+proj=robin")
ii <- indicatrix(r)
plot(ii, scale = 6e5, add = FALSE, show.axes  = TRUE, show.circle = TRUE)
tissot_map()
```

## Colour-coded distortion

Pass `fill.by` to colour ellipses by a distortion metric:

```{r coloured}
plot(ii, scale = 6e5, add = FALSE, fill.by = "scale.area")
tissot_map()
```

## Projection comparison

```{r mollweide}
m <- tissot(xy, "+proj=moll")
plot(indicatrix(m), scale = 5e5, add = FALSE)
tissot_map()
```

```{r mercator}
merc_xy <- expand.grid(seq(-150, 150, by = 30), seq(-75, 75, by = 15))
me <- tissot(merc_xy, "+proj=merc")
plot(indicatrix(me), scale = 5e5, add = FALSE)
tissot_map()
```

## Rich single-indicatrix plots

A single indicatrix with axes and reference circle:

```{r single2}
ii2 <- indicatrix(c(147, -42), "+proj=lcc +lat_1=-36 +lat_2=-38 +lat_0=-37 +lon_0=145")
plot(ii2[[1]], scale = 1e4, add = FALSE, show.axes = TRUE, show.circle = TRUE)
```


```{r single3}
ii3 <- indicatrix(c(147, -42), "+proj=lcc +lat_1=-15 +lat_2=5 +lat_0=0 +lon_0=145")
plot(ii3[[1]], scale = 1e4, add = FALSE, show.axes = TRUE, show.circle = TRUE)
```


## Arbitrary projections

Lambert Conformal Conic

```{r lcc}
pxy <- expand.grid(seq(100, 200, by = 25), seq(-75, -45, by = 10))
p <- tissot(pxy, "+proj=lcc +lat_0=-60 +lon_0=147 +lat_1=-70 +lat_2=-55")
plot(indicatrix(p), scale = 3e5, add = FALSE, fill.by = "scale.area")
tissot_map()
```

Universal Transverse Mercator

```{r utm}
qxy <- expand.grid(seq(100, 200, by = 25), seq(-75, -45, by = 10))
p <- tissot(qxy, "EPSG:32755")
plot(indicatrix(p), scale = 3e5, add = FALSE, fill.by = "scale.area")
tissot_map()
```


## Polar projections

```{r polar}
polar_xy <- expand.grid(seq(-180, 150, by = 30), seq(-80, -50, by = 10))
p <- tissot(polar_xy, "+proj=stere +lat_0=-90 +lon_0=147")
plot(indicatrix(p), scale = 2.5e5, add = FALSE, fill.by = "scale.area")
tissot_map()
```

```{r laea}
la <- tissot(polar_xy, "+proj=laea +lat_0=-90 +lon_0=147")
plot(indicatrix(la), scale = 2.5e5, add = FALSE)
tissot_map()
```

Let's push away from the pole in Lambert Azimuthal Equidistant

```{r aeqd}
lea <- tissot(polar_xy, "+proj=aeqd +lat_0=-20 +lon_0=147")
plot(indicatrix(lea), scale = 2.5e5, add = FALSE)
tissot_map()
```

## Distortion summary

```{r summary}
summary(r)
```


## Why this package?

Most "Tissot indicatrix" plots you'll find online are just geographic
circles drawn on the map. They show what happens to a circle under
the projection, which is useful â€” but it's not the indicatrix.
The indicatrix is the Jacobian of the projection at a point: it gives
you actual scale factors, angular deformation, and areal distortion.
This package computes those.

Other examples: [mgimond](https://mgimond.github.io/tissot/). 


## Code of Conduct

Please note that the tissot project is released with a
[Contributor Code of Conduct](https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html).
By contributing to this project, you agree to abide by its terms.
